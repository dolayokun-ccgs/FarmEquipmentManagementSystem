import { PrismaClient } from '@prisma/client';
import * as bcrypt from 'bcryptjs';

const prisma = new PrismaClient();

// Equipment images (using free stock images)
const equipmentImages = {
  tractor: [
    'https://images.unsplash.com/photo-1560493676-04071c5f467b?w=800',
    'https://images.unsplash.com/photo-1574943320219-553eb213f72d?w=800',
    'https://images.unsplash.com/photo-1625246333195-78d9c38ad449?w=800',
  ],
  harvester: [
    'https://images.unsplash.com/photo-1589923188900-85dae523342b?w=800',
    'https://images.unsplash.com/photo-1625246421433-c7e2c6a8d0b7?w=800',
  ],
  planter: [
    'https://images.unsplash.com/photo-1625246293087-3b0c0c67e6f4?w=800',
    'https://images.unsplash.com/photo-1592982537447-7440770cbfc9?w=800',
  ],
  sprayer: [
    'https://images.unsplash.com/photo-1625246421433-c7e2c6a8d0b7?w=800',
  ],
  cultivator: [
    'https://images.unsplash.com/photo-1560493676-04071c5f467b?w=800',
  ],
  irrigation: [
    'https://images.unsplash.com/photo-1416879595882-3373a0480b5b?w=800',
    'https://images.unsplash.com/photo-1625246333195-78d9c38ad449?w=800',
  ],
};

async function main() {
  console.log('ðŸŒ± Starting database seeding...\n');

  // Hash password for all users
  const hashedPassword = await bcrypt.hash('password123', 10);

  // 1. Create Categories
  console.log('ðŸ“ Creating categories...');
  const categories = await Promise.all([
    prisma.category.create({
      data: {
        name: 'Tractors',
        description: 'Various types of tractors for farming operations',
        iconUrl: 'ðŸšœ',
      },
    }),
    prisma.category.create({
      data: {
        name: 'Harvesters',
        description: 'Combine harvesters and harvesting equipment',
        iconUrl: 'ðŸŒ¾',
      },
    }),
    prisma.category.create({
      data: {
        name: 'Planters & Seeders',
        description: 'Equipment for planting and seeding',
        iconUrl: 'ðŸŒ±',
      },
    }),
    prisma.category.create({
      data: {
        name: 'Irrigation Systems',
        description: 'Water irrigation and sprinkler systems',
        iconUrl: 'ðŸ’§',
      },
    }),
    prisma.category.create({
      data: {
        name: 'Sprayers',
        description: 'Pesticide and fertilizer sprayers',
        iconUrl: 'ðŸ’¨',
      },
    }),
    prisma.category.create({
      data: {
        name: 'Cultivators',
        description: 'Soil cultivation and tillage equipment',
        iconUrl: 'âš™ï¸',
      },
    }),
  ]);
  console.log(`âœ“ Created ${categories.length} categories\n`);

  // 2. Create Government Equipment Owners
  console.log('ðŸ‘¥ Creating government equipment owners...');
  const owners = await Promise.all([
    prisma.user.create({
      data: {
        email: 'lagos.agric@gov.ng',
        passwordHash: hashedPassword,
        firstName: 'Lagos State',
        lastName: 'Agricultural Development',
        phoneNumber: '+234 800 123 4567',
        state: 'Lagos',
        lga: 'Ikeja',
        role: 'PLATFORM_OWNER',
        isVerified: true,
      },
    }),
    prisma.user.create({
      data: {
        email: 'kano.agric@gov.ng',
        passwordHash: hashedPassword,
        firstName: 'Kano State',
        lastName: 'Agricultural Agency',
        phoneNumber: '+234 800 234 5678',
        state: 'Kano',
        lga: 'Kano Municipal',
        role: 'PLATFORM_OWNER',
        isVerified: true,
      },
    }),
    prisma.user.create({
      data: {
        email: 'oyo.agric@gov.ng',
        passwordHash: hashedPassword,
        firstName: 'Oyo State',
        lastName: 'Ministry of Agriculture',
        phoneNumber: '+234 800 345 6789',
        state: 'Oyo',
        lga: 'Ibadan North',
        role: 'PLATFORM_OWNER',
        isVerified: true,
      },
    }),
    prisma.user.create({
      data: {
        email: 'kaduna.agric@gov.ng',
        passwordHash: hashedPassword,
        firstName: 'Kaduna State',
        lastName: 'Agricultural Development',
        phoneNumber: '+234 800 456 7890',
        state: 'Kaduna',
        lga: 'Kaduna North',
        role: 'PLATFORM_OWNER',
        isVerified: true,
      },
    }),
    prisma.user.create({
      data: {
        email: 'rivers.agric@gov.ng',
        passwordHash: hashedPassword,
        firstName: 'Rivers State',
        lastName: 'Agricultural Program',
        phoneNumber: '+234 800 567 8901',
        state: 'Rivers',
        lga: 'Port Harcourt',
        role: 'PLATFORM_OWNER',
        isVerified: true,
      },
    }),
  ]);
  console.log(`âœ“ Created ${owners.length} government equipment owners\n`);

  // 3. Create Farmers
  console.log('ðŸ‘¨â€ðŸŒ¾ Creating farmers...');
  const farmerNames = [
    { firstName: 'Chinedu', lastName: 'Okafor', state: 'Enugu', lga: 'Enugu North' },
    { firstName: 'Aisha', lastName: 'Mohammed', state: 'Kano', lga: 'Gwale' },
    { firstName: 'Oluwaseun', lastName: 'Adeyemi', state: 'Oyo', lga: 'Ibadan South' },
    { firstName: 'Fatima', lastName: 'Bello', state: 'Kaduna', lga: 'Zaria' },
    { firstName: 'Emeka', lastName: 'Nwosu', state: 'Abia', lga: 'Aba North' },
    { firstName: 'Blessing', lastName: 'Okonkwo', state: 'Anambra', lga: 'Awka South' },
    { firstName: 'Ibrahim', lastName: 'Musa', state: 'Kano', lga: 'Dala' },
    { firstName: 'Chioma', lastName: 'Eze', state: 'Imo', lga: 'Owerri Municipal' },
    { firstName: 'Yusuf', lastName: 'Abubakar', state: 'Kaduna', lga: 'Kafanchan' },
    { firstName: 'Ngozi', lastName: 'Obi', state: 'Enugu', lga: 'Nsukka' },
    { firstName: 'Adamu', lastName: 'Garba', state: 'Kano', lga: 'Nassarawa' },
    { firstName: 'Funmilayo', lastName: 'Ogunleye', state: 'Oyo', lga: 'Ogbomosho' },
    { firstName: 'Tunde', lastName: 'Bakare', state: 'Lagos', lga: 'Epe' },
    { firstName: 'Amina', lastName: 'Suleiman', state: 'Kaduna', lga: 'Kaduna South' },
    { firstName: 'Kemi', lastName: 'Williams', state: 'Ogun', lga: 'Abeokuta South' },
  ];

  const farmers = await Promise.all(
    farmerNames.map((farmer, index) =>
      prisma.user.create({
        data: {
          email: `${farmer.firstName.toLowerCase()}.${farmer.lastName.toLowerCase()}@farmer.ng`,
          passwordHash: hashedPassword,
          firstName: farmer.firstName,
          lastName: farmer.lastName,
          phoneNumber: `+234 ${70 + index}0 ${Math.floor(Math.random() * 900) + 100} ${Math.floor(Math.random() * 9000) + 1000}`,
          state: farmer.state,
          lga: farmer.lga,
          role: 'FARMER',
          isVerified: true,
        },
      })
    )
  );
  console.log(`âœ“ Created ${farmers.length} farmers\n`);

  // 4. Create Equipment
  console.log('ðŸšœ Creating equipment...');
  const equipmentData = [
    // Lagos State Equipment
    {
      ownerId: owners[0].id,
      name: 'John Deere 5075E Tractor',
      description: 'Modern utility tractor perfect for medium-scale farming operations. Features air-conditioned cabin, power steering, and excellent fuel efficiency.',
      categoryId: categories[0].id,
      pricePerDay: 45000,
      condition: 'EXCELLENT',
      locationAddress: 'Lagos State Agricultural Development Authority',
      locationCity: 'Ikeja',
      locationState: 'Lagos',
      images: JSON.stringify(equipmentImages.tractor),
      specifications: JSON.stringify({
        'Engine Power': '75 HP',
        'Transmission': 'Automatic',
        'Year': '2022',
        'Fuel Type': 'Diesel',
        'Working Hours': '500 hours',
      }),
      tags: JSON.stringify(['land_preparation', 'planting']),
      isAvailable: true,
    },
    {
      ownerId: owners[0].id,
      name: 'Massey Ferguson 385 4WD Tractor',
      description: 'Versatile 111HP compact tractor with cab. Perfect for livestock farms and crop production. Features hydraulic shuttle transmission and comfortable operator cabin.',
      categoryId: createdCategories['Tractors'].id,
      pricePerDay: 35000,
      condition: 'GOOD',
      locationAddress: 'Abeokuta Industrial Area',
      locationCity: 'Abeokuta',
      locationState: 'Ogun',
      latitude: 7.1475,
      longitude: 3.3619,
      images: JSON.stringify([
        '/images/equipment/tractor-kubota.jpg',
      ]),
      specifications: JSON.stringify({
        'Engine Power': '111 HP',
        'Drive Type': '4WD',
        'Transmission': 'Hydraulic Shuttle',
        'Cabin': 'Enclosed with AC',
        'Fuel Type': 'Diesel',
      }),
    },

    // Tillers & Cultivators
    {
      ownerId: owner1.id,
      name: 'Rotary Tiller 6ft Wide',
      description: 'Heavy-duty 6ft rotary tiller for soil preparation. Suitable for tractors 40HP and above. Perfect for breaking new ground and preparing seed beds.',
      categoryId: createdCategories['Tillers & Cultivators'].id,
      pricePerDay: 8000,
      condition: 'GOOD',
      locationAddress: '12 Farm Road, Ibadan',
      locationCity: 'Ibadan',
      locationState: 'Oyo',
      latitude: 7.3775,
      longitude: 3.9470,
      images: JSON.stringify([
        '/images/equipment/rotary-tiller.jpg',
      ]),
      specifications: JSON.stringify({
        'Width': '6 feet (1.8m)',
        'Tilling Depth': 'Up to 8 inches',
        'Required Tractor HP': '40+ HP',
        'Blades': 'Hardened steel',
        'PTO Speed': '540 RPM',
      }),
    },
    {
      ownerId: owner2.id,
      name: 'Walk-Behind Power Tiller',
      description: 'Compact 7HP walk-behind tiller ideal for small farms and gardens. Easy to maneuver and perfect for vegetable farming.',
      categoryId: createdCategories['Tillers & Cultivators'].id,
      pricePerDay: 5000,
      condition: 'EXCELLENT',
      locationAddress: 'Abeokuta Industrial Area',
      locationCity: 'Abeokuta',
      locationState: 'Ogun',
      latitude: 7.1475,
      longitude: 3.3619,
      images: JSON.stringify([
        '/images/equipment/power-tiller.jpg',
      ]),
      specifications: JSON.stringify({
        'Engine Power': '7 HP',
        'Fuel Type': 'Petrol',
        'Tilling Width': '24 inches',
        'Tilling Depth': 'Up to 6 inches',
        'Weight': '65 kg',
      }),
    },

    // Planting Equipment
    {
      ownerId: owner1.id,
      name: 'Maize Seed Planter (4-Row)',
      description: 'Precision 4-row maize planter with adjustable spacing. Ensures uniform seed distribution and optimal plant population.',
      categoryId: createdCategories['Planting Equipment'].id,
      pricePerDay: 12000,
      condition: 'GOOD',
      locationAddress: '12 Farm Road, Ibadan',
      locationCity: 'Ibadan',
      locationState: 'Oyo',
      latitude: 7.3775,
      longitude: 3.9470,
      images: JSON.stringify([
        '/images/equipment/maize-planter.jpg',
      ]),
      specifications: JSON.stringify({
        'Number of Rows': '4',
        'Row Spacing': 'Adjustable (75cm standard)',
        'Seed Hopper': '20 kg capacity',
        'Fertilizer Hopper': '15 kg capacity',
        'Required Tractor HP': '35+ HP',
      }),
    },
    {
      ownerId: owner2.id,
      name: 'Rice Transplanter',
      description: 'Manual rice transplanter for paddy fields. Increases planting efficiency and reduces labor costs.',
      categoryId: createdCategories['Planting Equipment'].id,
      pricePerDay: 6000,
      condition: 'FAIR',
      locationAddress: 'Abeokuta Industrial Area',
      locationCity: 'Abeokuta',
      locationState: 'Ogun',
      latitude: 7.1475,
      longitude: 3.3619,
      images: JSON.stringify([
        '/images/equipment/rice-transplanter.jpg',
      ]),
      specifications: JSON.stringify({
        'Type': 'Manual/Walk-behind',
        'Number of Rows': '6',
        'Row Spacing': '30 cm',
        'Planting Speed': '0.5 acre/day',
      }),
    },

    // Harvesting Equipment
    {
      ownerId: owner1.id,
      name: 'Mini Combine Harvester',
      description: 'Compact combine harvester suitable for rice, wheat, and other grains. Perfect for small to medium farms.',
      categoryId: createdCategories['Harvesting Equipment'].id,
      pricePerDay: 45000,
      condition: 'EXCELLENT',
      locationAddress: '12 Farm Road, Ibadan',
      locationCity: 'Ibadan',
      locationState: 'Oyo',
      latitude: 7.3775,
      longitude: 3.9470,
      images: JSON.stringify([
        '/images/equipment/combine-harvester.jpg',
      ]),
      specifications: JSON.stringify({
        'Engine Power': '48 HP',
        'Working Width': '1.2 meters',
        'Grain Tank': '400 kg',
        'Fuel Type': 'Diesel',
        'Harvesting Speed': '1 acre/hour',
      }),
    },
    {
      ownerId: owner2.id,
      name: 'Cassava Harvester',
      description: 'Tractor-mounted cassava harvester. Efficiently digs and lifts cassava tubers with minimal damage.',
      categoryId: createdCategories['Harvesting Equipment'].id,
      pricePerDay: 18000,
      condition: 'GOOD',
      locationAddress: 'Abeokuta Industrial Area',
      locationCity: 'Abeokuta',
      locationState: 'Ogun',
      latitude: 7.1475,
      longitude: 3.3619,
      images: JSON.stringify([
        '/images/equipment/cassava-harvester.jpg',
      ]),
      specifications: JSON.stringify({
        'Type': 'Tractor-mounted',
        'Working Width': '90 cm',
        'Depth': 'Up to 40 cm',
        'Required Tractor HP': '50+ HP',
      }),
    },

    // Irrigation Systems
    {
      ownerId: owner1.id,
      name: 'Diesel Water Pump 3-inch',
      description: 'High-capacity 3-inch diesel water pump. Ideal for irrigation, drainage, and water transfer. Flow rate up to 60,000 liters per hour.',
      categoryId: createdCategories['Irrigation Systems'].id,
      pricePerDay: 7000,
      condition: 'EXCELLENT',
      locationAddress: '12 Farm Road, Ibadan',
      locationCity: 'Ibadan',
      locationState: 'Oyo',
      latitude: 7.3775,
      longitude: 3.9470,
      images: JSON.stringify([
        '/images/equipment/water-pump.jpg',
      ]),
      specifications: JSON.stringify({
        'Engine Type': 'Diesel',
        'Inlet/Outlet': '3 inches',
        'Max Flow': '60,000 L/hour',
        'Max Head': '25 meters',
        'Fuel Tank': '15 liters',
      }),
    },
    {
      ownerId: owner2.id,
      name: 'Drip Irrigation System (1 Acre)',
      description: 'Complete drip irrigation kit for 1 acre. Includes main line, lateral lines, drippers, and filters. Water-efficient system.',
      categoryId: createdCategories['Irrigation Systems'].id,
      pricePerDay: 4000,
      condition: 'GOOD',
      locationAddress: 'Abeokuta Industrial Area',
      locationCity: 'Abeokuta',
      locationState: 'Ogun',
      latitude: 7.1475,
      longitude: 3.3619,
      images: JSON.stringify([
        '/images/equipment/drip-irrigation.jpg',
      ]),
      specifications: JSON.stringify({
        'Coverage': '1 acre',
        'Dripper Spacing': '30 cm',
        'Flow Rate': '2-4 L/hour per dripper',
        'Filter Type': 'Screen filter',
        'Pressure Requirement': '1-2 bar',
      }),
    },

    // Sprayers
    {
      ownerId: owner1.id,
      name: 'Motorized Knapsack Sprayer',
      description: 'Petrol-powered knapsack sprayer with 20L tank. Perfect for pesticide and fertilizer application on medium-sized farms.',
      categoryId: createdCategories['Sprayers'].id,
      pricePerDay: 3500,
      condition: 'EXCELLENT',
      locationAddress: '12 Farm Road, Ibadan',
      locationCity: 'Ibadan',
      locationState: 'Oyo',
      latitude: 7.3775,
      longitude: 3.9470,
      images: JSON.stringify([
        '/images/equipment/boom-sprayer.jpg',
      ]),
      specifications: JSON.stringify({
        'Engine Type': 'Petrol 2-stroke',
        'Tank Capacity': '20 liters',
        'Spray Range': 'Up to 8 meters',
        'Coverage': '2-3 acres/day',
        'Weight': '10 kg (empty)',
      }),
    },
    {
      ownerId: owner2.id,
      name: 'Boom Sprayer (Tractor-Mounted)',
      description: 'Tractor-mounted boom sprayer with 200L tank and 6-meter boom. Efficient coverage for large fields.',
      categoryId: createdCategories['Sprayers'].id,
      pricePerDay: 15000,
      condition: 'GOOD',
      locationAddress: 'Abeokuta Industrial Area',
      locationCity: 'Abeokuta',
      locationState: 'Ogun',
      latitude: 7.1475,
      longitude: 3.3619,
      images: JSON.stringify([
        '/images/equipment/drip-irrigation.jpg',
      ]),
      specifications: JSON.stringify({
        'Tank Capacity': '200 liters',
        'Boom Width': '6 meters',
        'Nozzles': 'Adjustable',
        'Required Tractor HP': '40+ HP',
        'Coverage': '5-8 acres/hour',
      }),
    },

    // Mowers & Cutters
    {
      ownerId: owner1.id,
      name: 'Brush Cutter (Petrol)',
      description: 'Professional-grade petrol brush cutter for clearing vegetation and grass. Includes blade and trimmer line head.',
      categoryId: createdCategories['Mowers & Cutters'].id,
      pricePerDay: 2500,
      condition: 'EXCELLENT',
      locationAddress: '12 Farm Road, Ibadan',
      locationCity: 'Ibadan',
      locationState: 'Oyo',
      latitude: 7.3775,
      longitude: 3.9470,
      images: JSON.stringify([
        '/images/equipment/brush-cutter.jpg',
      ]),
      specifications: JSON.stringify({
        'Engine': '2-stroke petrol',
        'Displacement': '52cc',
        'Cutting Width': '45 cm',
        'Weight': '7.5 kg',
        'Attachments': 'Blade and trimmer head',
      }),
    },
    {
      ownerId: owner2.id,
      name: 'Hay Mower (Tractor-Mounted)',
      description: 'Rotary hay mower for cutting grass and fodder. Suitable for small to medium livestock farms.',
      categoryId: createdCategories['Mowers & Cutters'].id,
      pricePerDay: 10000,
      condition: 'GOOD',
      locationAddress: 'Abeokuta Industrial Area',
      locationCity: 'Abeokuta',
      locationState: 'Ogun',
      latitude: 7.1475,
      longitude: 3.3619,
      images: JSON.stringify([
        '/images/equipment/combine-harvester.jpg',
      ]),
      specifications: JSON.stringify({
        'Cutting Width': '1.2 meters',
        'Type': 'Rotary disc',
        'Required Tractor HP': '30+ HP',
        'PTO Speed': '540 RPM',
      }),
    },

    // Post Harvest Equipment
    {
      ownerId: owner1.id,
      name: 'Multi-Crop Thresher',
      description: 'Versatile thresher for maize, beans, rice, and other grains. Electric motor powered, suitable for small processing operations.',
      categoryId: createdCategories['Post Harvest Equipment'].id,
      pricePerDay: 8000,
      condition: 'GOOD',
      locationAddress: '12 Farm Road, Ibadan',
      locationCity: 'Ibadan',
      locationState: 'Oyo',
      latitude: 7.3775,
      longitude: 3.9470,
      images: JSON.stringify([
        '/images/equipment/combine-harvester.jpg',
      ]),
      specifications: JSON.stringify({
        'Motor': '5 HP electric',
        'Capacity': '500 kg/hour',
        'Suitable Crops': 'Maize, beans, rice, wheat',
        'Power': '220V single phase',
      }),
    },
    {
      ownerId: owner2.id,
      name: 'Grain Winnower',
      description: 'Electric grain cleaning and winnowing machine. Removes chaff and foreign materials from harvested grains.',
      categoryId: createdCategories['Post Harvest Equipment'].id,
      pricePerDay: 5000,
      condition: 'EXCELLENT',
      locationAddress: 'Abeokuta Industrial Area',
      locationCity: 'Abeokuta',
      locationState: 'Ogun',
      latitude: 7.1475,
      longitude: 3.3619,
      images: JSON.stringify([
        '/images/equipment/rice-transplanter.jpg',
      ]),
      specifications: JSON.stringify({
        'Motor': '3 HP electric',
        'Capacity': '300 kg/hour',
        'Cleaning Efficiency': '98%',
        'Power': '220V',
      }),
    },

    // Transport & Handling
    {
      ownerId: owner1.id,
      name: 'Farm Trailer (2-Ton Capacity)',
      description: 'Heavy-duty farm trailer for transporting produce, equipment, and materials. Hydraulic tipping feature.',
      categoryId: createdCategories['Transport & Handling'].id,
      pricePerDay: 6000,
      condition: 'GOOD',
      locationAddress: '12 Farm Road, Ibadan',
      locationCity: 'Ibadan',
      locationState: 'Oyo',
      latitude: 7.3775,
      longitude: 3.9470,
      images: JSON.stringify([
        '/images/equipment/cassava-harvester.jpg',
      ]),
      specifications: JSON.stringify({
        'Capacity': '2 tons',
        'Bed Size': '2.5m x 1.5m',
        'Tipping': 'Hydraulic',
        'Wheels': 'Dual axle',
        'Hitch': 'Standard tractor hitch',
      }),
    },

    // Power Tools
    {
      ownerId: owner2.id,
      name: 'Diesel Generator 10KVA',
      description: 'Reliable 10KVA diesel generator for powering farm operations. Suitable for irrigation pumps, processing equipment, and lighting.',
      categoryId: createdCategories['Power Tools'].id,
      pricePerDay: 9000,
      condition: 'EXCELLENT',
      locationAddress: 'Abeokuta Industrial Area',
      locationCity: 'Abeokuta',
      locationState: 'Ogun',
      latitude: 7.1475,
      longitude: 3.3619,
      images: JSON.stringify([
        '/images/equipment/diesel-generator.jpg',
      ]),
      specifications: JSON.stringify({
        'Power Output': '10 KVA / 8 KW',
        'Engine': 'Diesel',
        'Fuel Tank': '40 liters',
        'Runtime': '8-10 hours (full tank)',
        'Voltage': '220V/380V',
      }),
    },
  ];

  const equipment = await Promise.all(
    equipmentData.map((eq) => prisma.equipment.create({ data: eq }))
  );
  console.log(`âœ“ Created ${equipment.length} equipment items\n`);

  console.log('âœ… Database seeding completed successfully!\n');
  console.log('ðŸ“Š Summary:');
  console.log(`   - Categories: ${categories.length}`);
  console.log(`   - Government Owners: ${owners.length}`);
  console.log(`   - Farmers: ${farmers.length}`);
  console.log(`   - Equipment: ${equipment.length}`);
  console.log('\nðŸ” Login Credentials:');
  console.log('\n   Government Equipment Owners:');
  owners.forEach((owner) => {
    console.log(`   - Email: ${owner.email}`);
  });
  console.log('\n   Sample Farmers:');
  farmers.slice(0, 5).forEach((farmer) => {
    console.log(`   - Email: ${farmer.email}`);
  });
  console.log('\n   Password for all accounts: password123');
  console.log('\nðŸŒ You can now browse equipment at: http://localhost:3001/equipment');
}

main()
  .catch((e) => {
    console.error('âŒ Error seeding database:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
